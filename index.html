<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AARIA Chatbot</title>

<!-- ============= CSS ============= -->
<style>
#aariaPopup {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 350px;
  height: 520px;
  background: #ffffff;
  border-radius: 18px;
  display: none;
  flex-direction: column;
  box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  z-index: 999999;
}

@media(max-width:768px){
  #aariaPopup {
    bottom: 50%;
    right: 50%;
    transform: translate(50%,50%);
    width: 90%;
    height: 70%;
  }
}

#aariaHeader {
  background: #075E54;
  color: white;
  padding: 14px;
  font-size: 18px;
  font-weight: bold;
}

#aariaChat {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
  background: #ECE5DD;
  font-family: sans-serif;
}

.msgUser {
  background: #DCF8C6;
  padding: 10px 14px;
  max-width: 75%;
  border-radius: 10px;
  margin: 8px 0;
  margin-left: auto;
}

.msgBot {
  background: white;
  padding: 10px 14px;
  max-width: 75%;
  border-radius: 10px;
  margin: 8px 0;
  margin-right: auto;
  border: 1px solid #ddd;
}

#aariaInputArea {
  display: flex;
  padding: 10px;
  background: #fff;
}

#aariaInput {
  flex: 1;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #aaa;
}
</style>

</head>
<body>

<!-- ============= CHAT POPUP UI ============= -->
<div id="aariaPopup">
  <div id="aariaHeader">AARIA • Chat Support</div>
  <div id="aariaChat"></div>

  <div id="aariaInputArea">
    <input id="aariaInput" placeholder="Type your message…" />
    <button onclick="sendAaria()" 
      style="margin-left:8px;background:#128C7E;color:white;border:none;padding:8px 14px;border-radius:8px;">
      Send
    </button>
  </div>
</div>

<!-- ============= SCRIPT ============= -->
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyJXKJ3A3KRx-ktVU69OzcNVBBAR-Fu6j8Vzf5OrGF30JtdWJkdrb0icKP0CfJrQLzhDw/exec"; // <-- Replace with real URL
const sessionId = localStorage.getItem("aaria_session") || Math.random().toString(36).slice(2);
localStorage.setItem("aaria_session", sessionId);

function showAaria() {
  document.getElementById("aariaPopup").style.display = "flex";
}

function addMessage(role, text) {
  const chat = document.getElementById("aariaChat");
  const div = document.createElement("div");
  div.className = (role === "user") ? "msgUser" : "msgBot";
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function sendAaria() {
  const input = document.getElementById("aariaInput");
  const msg = input.value.trim();
  if (!msg) return;

  addMessage("user", msg);
  input.value = "";

  const res = await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ message: msg, sessionId }),
    headers: { "Content-Type": "application/json" }
  });

  const data = await res.json();
  addMessage("bot", data.reply);
}
</script>

<!-- DEMO BUTTON TO OPEN CHAT -->
<button onclick="showAaria()" style="
  position:fixed; bottom:20px; left:20px; padding:12px 18px;
  background:#128C7E;color:white;border:none;border-radius:8px;">
  Chat With AARIA
</button>

</body>
</html>
